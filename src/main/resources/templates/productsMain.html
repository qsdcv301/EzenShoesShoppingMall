<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Shoes Shop</title>
    <!-- 부트스트랩 아이콘 사용 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet"/>
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/style.css" rel="stylesheet"/>
    <script src="/js/jquery-1.12.4.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/mainpage.js"></script>
    <script src="/js/script.js"></script>
</head>

<body>
<header th:replace="~{fragments/header :: header}"></header>
<!--  <header>-->
<!--    <div class="notice-container"></div>-->
<!--    <nav class="navbar navbar-expand-lg navbar-light bg-white">-->
<!--      <div class="container-fluid">-->
<!--        &lt;!&ndash; 로고 &ndash;&gt;-->
<!--        <div class="class col-2">-->
<!--          <a class="navbar-brand" href="productsMain.html">-->
<!--            <img src="https://upload.wikimedia.org/wikipedia/commons/2/20/Adidas_Logo.svg" alt="Adidas Logo" />-->
<!--          </a>-->
<!--        </div>-->
<!--        &lt;!&ndash; 내비게이션 &ndash;&gt;-->
<!--        <div class="collapse navbar-collapse col-6 position-relative">-->
<!--          <ul class="navbar-nav mb-2 mb-lg-0 position-absolute">-->
<!--            <li class="nav-item ml-auto mr-auto">-->
<!--              <a class="nav-link" href="#">Poplular</a>-->
<!--            </li>-->
<!--            <li class="nav-item ml-auto mr-auto">-->
<!--              <a class="nav-link font-weight-bold" href="#">Nike</a>-->
<!--            </li>-->
<!--            <li class="nav-item ml-auto mr-auto">-->
<!--              <a class="nav-link font-weight-bold" href="#">Adidas</a>-->
<!--            </li>-->
<!--            <li class="nav-item ml-auto mr-auto">-->
<!--              <a class="nav-link font-weight-bold" href="#">NewBalance</a>-->
<!--            </li>-->
<!--            <li class="nav-item ml-auto mr-auto">-->
<!--              <a class="nav-link font-weight-bold" href="#">ETC</a>-->
<!--            </li>-->
<!--            <li class="nav-item ml-auto mr-auto">-->
<!--              <a class="nav-link" href="#">Sale</a>-->
<!--            </li>-->
<!--          </ul>-->
<!--        </div>-->

<!--        &lt;!&ndash; 사용자 섹션 &ndash;&gt;-->
<!--        <div class="user-sec col-2 position-relative">-->
<!--          <div class="top-links position-absolute">-->
<!--            <a href="#" class="mr-2">도움말</a>-->
<!--            <a href="#" class="mr-2">주문 및 반품</a>-->
<!--            <a href="#" class="mr-2">가입하기</a>-->
<!--          </div>-->

<!--          &lt;!&ndash; 검색 바 &ndash;&gt;-->
<!--          <form class="d-flex search-bar position-absolute">-->
<!--            <div class="input-group">-->
<!--              <input class="form-control" type="search" placeholder="Search" aria-label="Search" />-->
<!--              <div class="input-group-append">-->
<!--                <button class="btn" type="submit">-->
<!--                  <i class="bi bi-search"></i>-->
<!--                </button>-->
<!--              </div>-->
<!--            </div>-->
<!--          </form>-->
<!--          &lt;!&ndash; 사용자 메뉴 &ndash;&gt;-->
<!--          <div class="d-flex user-menu position-absolute">-->
<!--            <a href="#" class="navi-link icon">-->
<!--              <i class="bi bi-person"></i>-->
<!--            </a>-->
<!--            <a href="#" class="navi-link icon">-->
<!--              <i class="bi bi-heart"></i>-->
<!--            </a>-->
<!--            <a href="#" class="navi-link icon">-->
<!--              <i class="bi bi-bag"></i>-->
<!--            </a>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </nav>-->
<!--    <div class="header-menu"></div>-->
<!--  </header>-->

<div class="productsMain-products container">
    <div class="row">
        <div class="col-12">
            <div class="list-group list-group-horizontal align-items-center">
                <a class="list-group-item border-0 px-2" th:href="@{/}">Home</a> /
                <a class="list-group-item border-0 px-2" th:href="@{/products(category=${category})}">Nike</a> /
                <a class="list-group-item border-0 px-2" th:href="@{/products(category=${category})}">Running</a>
            </div>
        </div>
        <div class="col-12">
            <div class="pl-3">
                <h2 class="pl-3 m-0 font-italic"><span th:text="${category}">카테고리</span> · <span>Running</span></h2>
                <h5 class="pl-3 m-0 font-italic text-uppercase" th:text="${category} + ' 의 ㅁㅁ상품'">설명글</h5>
                <div class="my-3 ml-2 bg-dark" style="width: 400px; height: 5px;"></div>
            </div>
        </div>
    </div>
    <div class="col-12">
        <div class="d-flex justify-content-between px-3 py-2">
            <div>
            </div>
            <button class="btn btn-secondary" type="button">
                Filter & Sort @
            </button>
        </div>
        <div class="col-12">
            <div class="d-flex flex-wrap products-images">
                <div class="col-4 mb-4" th:each="product, image : ${products}">
                    <a th:href="@{/productsDetail(productCode=${product.id}, category=${category})}" style="text-decoration: none; color: inherit;">
                        <div class="card">
                            <img th:alt="${product.name}" th:src="${imageUrls[image.index]}" />

                            <p class="pl-2 pt-2" th:text="${product.name}"></p>
                            <p class="pl-2" th:text="${product.description}"></p>
                            <p class="pl-2" th:text="${product.price} + ' 원'"></p>
                        </div>
                    </a>

                </div>
            </div>
        </div>
        <div class="col-12">
            <ul class="pagination justify-content-center">
                <li class="page-item"><a class="page-link" href="#">&lt;</a></li>
                <li class="page-item"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">4</a></li>
                <li class="page-item"><a class="page-link" href="#">5</a></li>
                <li class="page-item"><a class="page-link" href="#">&gt;</a></li>
            </ul>
        </div>
    </div>
</div>
<footer th:replace="~{fragments/footer :: footer}"></footer>
<script>

    /*****************************************************/
    // Home / Adidas/ Running<< 이부분 주소값이 받아와지는지

    $(document).ready(function () {
        // 현재 페이지의 URL에서 쿼리 파라미터를 가져옴
        const params = new URLSearchParams(window.location.search);

        // 'category'와 'subcategory' 파라미터 값 가져오기
        const category = params.get('category');
        const subcategory = params.get('subcategory');

        // 가져온 파라미터 값으로 페이지의 특정 요소를 업데이트하거나 버튼에 설정
        if (category) {
            console.log(`Category: ${category}`);
            $('#category-button').text(category);
        }

        if (subcategory) {
            console.log(`Subcategory: ${subcategory}`);
            $('#subcategory-button').text(subcategory);
        }

        // 동적 링크 설정: 카테고리 및 서브카테고리 버튼 클릭 시 URL에 데이터를 추가하고 리디렉트
        $(document).on('click', '#category-button, #subcategory-button', function(event) {
            event.preventDefault(); // 기본 링크 동작 방지

            const category = $(this).data('category');
            const subcategory = $(this).data('subcategory');

            // URL 생성 시 undefined 또는 렌더링되지 않은 변수가 있으면 제외
            let newUrl = `/products?category=${category}`;

            if (subcategory && subcategory !== "${subcategory}") {
                newUrl += `&subcategory=${encodeURIComponent(subcategory)}`;
            }

            // URL 리디렉션
            window.location.href = newUrl;
        });
    });
</script>
</body>
</html>